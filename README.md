This was written with the intentions of creating a dashboard in PowerBI

the main purpose of the SQl code is to clean and process (do calculations) on the data to make it ready for visualisation

this could've been done in powerquery and using mesures however i prefer importing the bare mininum amount of data to powerBI
